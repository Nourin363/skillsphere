{% extends 'adminpanel/admin_base.html' %}
{% block content %}
{% load static %}
<head>
    <meta charset="UTF-8">
    <title>SkillSphere Admin Panel</title>

    <!-- Tailwind for Admin UI -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Existing styles -->
    <link rel="stylesheet" href="{% static 'css/admin.css' %}">
</head>


<h1 class="text-3xl font-bold text-white mb-6">Edit Practice Question</h1>

<form method="post" class="bg-[#111121] p-6 rounded-xl max-w-3xl text-white">
  {% csrf_token %}

  <div class="mb-4">
    <label class="block mb-1 text-sm text-gray-300">Skill</label>
    <select name="skill" required
      class="w-full p-2 rounded bg-[#1b1b29] border border-[#34344d]">
      {% for skill in skills %}
      <option value="{{ skill.id }}" {% if question.skill.id == skill.id %}selected{% endif %}>
        {{ skill.name }}
      </option>
      {% endfor %}
    </select>
  </div>

  <div class="mb-4 flex gap-4">
    <div class="flex-1">
      <label class="block mb-1 text-sm text-gray-300">Question Type</label>
      <select name="question_type" id="qType"
        class="w-full p-2 rounded bg-[#1b1b29] border border-[#34344d]">
        <option value="MCQ" {% if question.question_type == 'MCQ' %}selected{% endif %}>Multiple Choice</option>
        <option value="SHORT" {% if question.question_type == 'SHORT' %}selected{% endif %}>Short Answer</option>
        <option value="CODE" {% if question.question_type == 'CODE' %}selected{% endif %}>Coding</option>
      </select>
    </div>

    <div class="flex-1">
      <label class="block mb-1 text-sm text-gray-300">Difficulty</label>
      <select name="difficulty"
        class="w-full p-2 rounded bg-[#1b1b29] border border-[#34344d]">
        <option value="Beginner" {% if question.difficulty == 'Beginner' %}selected{% endif %}>Beginner</option>
        <option value="Intermediate" {% if question.difficulty == 'Intermediate' %}selected{% endif %}>Intermediate</option>
        <option value="Advanced" {% if question.difficulty == 'Advanced' %}selected{% endif %}>Advanced</option>
        <option value="Expert" {% if question.difficulty == 'Expert' %}selected{% endif %}>Expert</option>
      </select>
    </div>
  </div>

  <div class="mb-4">
    <label class="block mb-1 text-sm text-gray-300">Question Text</label>
    <textarea name="question_text" rows="3" required
      class="w-full p-3 rounded bg-[#1b1b29] border border-[#34344d]">{{ question.question_text }}</textarea>
  </div>

  <div id="mcqFields" class="mb-4">
    <h3 class="text-sm text-gray-300 mb-2">MCQ Options</h3>
    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
      <input type="text" name="option_a" placeholder="Option A" value="{{ question.option_a }}"
        class="p-2 rounded bg-[#1b1b29] border border-[#34344d]">
      <input type="text" name="option_b" placeholder="Option B" value="{{ question.option_b }}"
        class="p-2 rounded bg-[#1b1b29] border border-[#34344d]">
      <input type="text" name="option_c" placeholder="Option C" value="{{ question.option_c }}"
        class="p-2 rounded bg-[#1b1b29] border border-[#34344d]">
      <input type="text" name="option_d" placeholder="Option D" value="{{ question.option_d }}"
        class="p-2 rounded bg-[#1b1b29] border border-[#34344d]">
    </div>

    <div class="mt-3">
      <label class="block mb-1 text-sm text-gray-300">Correct Option</label>
      <select name="correct_option"
        class="w-40 p-2 rounded bg-[#1b1b29] border border-[#34344d]">
        <option value="">Select</option>
        <option value="A" {% if question.correct_option == 'A' %}selected{% endif %}>A</option>
        <option value="B" {% if question.correct_option == 'B' %}selected{% endif %}>B</option>
        <option value="C" {% if question.correct_option == 'C' %}selected{% endif %}>C</option>
        <option value="D" {% if question.correct_option == 'D' %}selected{% endif %}>D</option>
      </select>
    </div>
  </div>

  <div id="textAnswerField" class="mb-4 hidden">
    <label class="block mb-1 text-sm text-gray-300">Correct Answer (for SHORT / CODE)</label>
    <textarea name="correct_text_answer" rows="3"
      class="w-full p-3 rounded bg-[#1b1b29] border border-[#34344d]">{{ question.correct_text_answer }}</textarea>
  </div>

  <button type="submit"
    class="mt-4 px-6 py-3 bg-purple-600 hover:bg-purple-700 rounded text-white font-semibold">
    Update Question
  </button>
</form>

<script>
  const qTypeSelect = document.getElementById("qType");
  const mcqFields = document.getElementById("mcqFields");
  const textField = document.getElementById("textAnswerField");

  function toggleQuestionFields() {
    const type = qTypeSelect.value;
    if (type === "MCQ") {
      mcqFields.classList.remove("hidden");
      textField.classList.add("hidden");
    } else {
      mcqFields.classList.add("hidden");
      textField.classList.remove("hidden");
    }
  }

  qTypeSelect.addEventListener("change", toggleQuestionFields);
  toggleQuestionFields();
</script>

{% endblock %}
