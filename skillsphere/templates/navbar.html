{% load static %}

<nav id="main-navbar" class="w-full bg-white dark:bg-gray-900 shadow-md transition-all duration-300">
  <div class="max-w-7xl mx-auto px-6 sm:px-8 lg:px-10 py-2">
    <div class="flex justify-between items-center h-16">

      <!-- ðŸŒ Logo -->
      <a href="/" class="flex items-center space-x-3 group">
        <img src="{% static 'images/skillphere_logo.png' %}" alt="SkillSphere Logo" class="w-12 h-12 sm:w-14 sm:h-14 object-contain transform group-hover:scale-110 transition duration-300">
        <span class="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 dark:from-purple-400 dark:to-blue-400 tracking-tight">
          SkillSphere
        </span>
      </a>

      <!-- ðŸ”— Navigation Links -->
      <div class="hidden md:flex space-x-8 text-sm font-medium items-center">
      
        {% if not request.user.is_authenticated %}
        <!-- BEFORE LOGIN â€” SHOW HOME -->
        <a href="/"
          class="{% if request.path == '/' %}text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 font-semibold{% else %}text-gray-700 dark:text-gray-300 hover:text-purple-600{% endif %}">
          Home
        </a>
        {% endif %}

      {% if request.user.is_authenticated %}
        <!-- AFTER LOGIN â€” SHOW DASHBOARD -->
        <a href="/dashboard/"
          class="{% if request.path == '/dashboard/' %}text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 font-semibold{% else %}text-gray-700 dark:text-gray-300 hover:text-purple-600{% endif %}">
          Dashboard
        </a>
        {% endif %}


        <!-- ALWAYS VISIBLE -->
        <a href="/skills/"
          class="{% if request.path == '/skills/' %}text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 font-semibold{% else %}text-gray-700 dark:text-gray-300 hover:text-purple-600{% endif %}">
          Skills
        </a>
      
        <a href="/internships/"
          class="{% if request.path == '/internships/' %}text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-blue-600 font-semibold{% else %}text-gray-700 dark:text-gray-300 hover:text-purple-600{% endif %}">
          Internships
        </a>
      
        {% if request.user.is_superuser %}
        <a href="/adminpanel/">Admin Panel</a>
        {% endif %}

      </div>


      <!-- ðŸŒ™ Theme Toggle + Auth/Profile -->
      <div class="flex items-center space-x-4">
        <!-- Theme Button -->
        <button id="theme-toggle"
                class="flex items-center space-x-1 text-gray-700 dark:text-gray-300 hover:text-purple-600 dark:hover:text-purple-400 focus:outline-none">
          <span id="theme-icon">ðŸŒ™</span>
          <span id="theme-text" class="hidden sm:inline">Dark Mode</span>
        </button>

       

        {% if request.user.is_authenticated %}
          <!-- ðŸ‘¤ Profile Dropdown -->
          <div class="relative" x-data="{ open: false }">
            <button @click="open = !open"
                    @keydown.escape="open = false"
                    class="flex items-center gap-2 px-3 py-2 rounded-full bg-gradient-to-r from-purple-500 to-blue-500 text-white font-semibold transition-all duration-300 ease-in-out shadow-md hover:scale-105"
                    :class="{ 'rounded-xl px-4 pr-5': open }">
              <div class="flex items-center justify-center w-9 h-9 bg-gradient-to-r from-purple-400 to-blue-400 rounded-full text-lg font-bold">
                {{ request.user.username|first|upper }}
              </div>
              <span x-show="open" x-transition.opacity.duration.300ms>{{ request.user.username }}</span>
            </button>

            <div x-show="open"
                 x-transition.origin.top.right
                 @click.away="open = false"
                 class="absolute right-0 mt-3 w-44 bg-[#1f2937] text-gray-200 rounded-xl shadow-lg border border-gray-700 z-50 overflow-hidden"
                 style="display: none;">
              <a href="{% url 'profile' %}" class="block px-4 py-2 hover:bg-gray-700 flex items-center gap-2">
                <i class="fa-solid fa-id-badge text-blue-400"></i> <span>Profile</span>
              </a>
              <a href="{% url 'skill_progress' %}" class="block px-4 py-2 hover:bg-gray-700 flex items-center gap-2 text-red-400">
                <i class="devicon-game-plain"></i> <span>Skill Progress</span> 
              </a>
              <a href="{% url 'logout' %}" class="block px-4 py-2 hover:bg-gray-700 flex items-center gap-2 text-red-400">
                <i class="fa-solid fa-right-from-bracket"></i> <span>Logout</span>
              </a>
            </div>
          </div>
        {% else %}
          <!-- ðŸšª Not Logged In -->
          <div class="flex space-x-3">
            <a href="{% url 'login' %}" class="px-5 py-2 rounded-xl bg-gradient-to-r from-purple-500 to-blue-500 text-white font-semibold hover:opacity-90 transition">Login</a>
            <a href="{% url 'register' %}" class="px-5 py-2 rounded-xl border border-purple-500 text-purple-500 font-semibold hover:bg-purple-500 hover:text-white transition">Register</a>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
</nav>

<!-- âœ¨ Navbar Scroll Animation -->
<style>
  nav {
    position: relative;
    transition: background-color 0.4s ease, box-shadow 0.4s ease, transform 0.3s ease;
  }
  nav.scrolled {
    background-color: rgba(255, 255, 255, 0.95);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
  }
  .dark nav.scrolled {
    background-color: rgba(17, 24, 39, 0.95);
  }
</style>

<script>
  document.addEventListener("scroll", () => {
    const nav = document.getElementById("main-navbar");
    if (window.scrollY > 10) nav.classList.add("scrolled");
    else nav.classList.remove("scrolled");
  });
</script>
